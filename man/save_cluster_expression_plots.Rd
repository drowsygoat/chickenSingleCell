% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/save_cluster_expression_plots.R
\name{save_cluster_expression_plots}
\alias{save_cluster_expression_plots}
\title{Save Cluster Expression Plots to Rasterized PDF or Return Plot List}
\usage{
save_cluster_expression_plots(
  split_data,
  log_scale = FALSE,
  file_prefix = "cluster_expression",
  save_as_pdf = TRUE,
  threads = 1,
  y_max = NULL
)
}
\arguments{
\item{split_data}{A named list of data frames, one per cluster. Each data frame
must contain the columns: \code{sample}, \code{expression}, and \code{assay}.}

\item{log_scale}{Logical. If \code{TRUE}, a log10-transformed y-axis is used.
Default: \code{FALSE} (linear y-axis).}

\item{file_prefix}{Character. Prefix for the output PDF filename. The plot will be saved as
\code{plots/<file_prefix>_linear.pdf} or \code{plots/<file_prefix>_log10.pdf} depending on the y-axis scale.}

\item{threads}{Integer. Number of threads to use for generating plots. If greater than 1,
enables parallel processing via \code{future.apply}. Default: 1 (no parallelism).
#' @param y_max Optional numeric. Maximum y-axis limit for linear plots to trim outliers.
Only used when \code{log_scale = FALSE}. Default: \code{NULL} (no limit).}

\item{plot}{Logical. If \code{TRUE} (default), saves the plots to a rasterized PDF.
If \code{FALSE}, returns the list of ggplot objects without saving.}
}
\value{
A named list of ggplot objects (one per cluster). If \code{plot = TRUE},
the list is returned invisibly after saving to PDF.
}
\description{
This function creates one expression plot per cluster from a list of data frames
and either saves the plots to a rasterized multi-page PDF or returns them as a list
of ggplot objects. Each plot shows expression values across samples, using
boxplots with quasirandom jitter. The function supports log10 transformation of the
y-axis and optional multithreading for faster plot generation.
}
\details{
The function uses either \code{pbapply::pblapply()} or \code{future.apply::future_lapply()}
depending on the value of \code{threads}. Plot rendering to PDF is done with
\code{ragg::raster_pdf()} for high-performance rasterized output.

If the output directory \code{plots/} does not exist, it is created automatically.
}
\examples{
# Generate and return plots without saving
plots <- save_cluster_expression_plots(split_data, plot = FALSE)

# Save rasterized plots and capture the list invisibly
plots <- save_cluster_expression_plots(split_data, plot = TRUE, threads = 4)

}
