% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AverageExpressionPerClusterPerSample.R
\name{AverageExpressionPerClusterPerSample}
\alias{AverageExpressionPerClusterPerSample}
\title{Calculate Aggregated (Pseudobulk) Expression per Cluster per Sample}
\usage{
AverageExpressionPerClusterPerSample(
  obj_list,
  assay = NULL,
  slot = "data",
  cluster_col = "seurat_clusters",
  normalization.method = c("LogNormalize", "CLR", "RC", "none"),
  scale.factor = 10000,
  ...
)
}
\arguments{
\item{obj_list}{A Seurat object or a list of Seurat objects.}

\item{assay}{The assay to use (e.g., \code{"RNA"} or \code{"SCT"}). If NULL, uses the object's active assay.}

\item{slot}{The expression slot to use. Default is \code{"data"}.}

\item{cluster_col}{Name of the metadata column containing cluster identities. Default is \code{"seurat_clusters"}.}

\item{normalization.method}{Method for normalization. Options:
\describe{
\item{"LogNormalize"}{(default) Divide feature counts by total counts per cell, multiply by \code{scale.factor}, then \code{log1p}}
\item{"CLR"}{Centered log-ratio transformation}
\item{"RC"}{Relative counts; divide by total counts per cell, multiply by \code{scale.factor}, no log}
\item{"none" or NULL}{No normalization (recommended for SCT residuals)}
}}

\item{scale.factor}{Scaling factor used in normalization. Default is \code{10000}.}

\item{...}{Additional arguments passed to \code{AggregateExpression()}.}
}
\value{
A named list of matrices. Each matrix contains aggregated gene expression (genes x clusters) for a sample.
}
\description{
Computes pseudobulk (summed) expression for each cluster within each sample.
Handles either a single Seurat object or a list of Seurat objects.
Uses \code{AggregateExpression()} and supports RNA, SCTransform, or other assays.
}
\examples{
# Default log-normalization (RNA)
result <- AverageExpressionPerClusterPerSample(seurat_obj)

# Pseudobulk counts without normalization (e.g., for SCT)
result <- AverageExpressionPerClusterPerSample(seurat_obj, assay = "SCT", normalization.method = "none")

# Counts per million
result <- AverageExpressionPerClusterPerSample(seurat_obj, normalization.method = "RC", scale.factor = 1e6)
}
